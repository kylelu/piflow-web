-- ----------------------------
-- Drop Table
-- ----------------------------
DROP TABLE IF EXISTS `FLOW_INFO`;
DROP TABLE IF EXISTS `FLOW_PROJECT`;
DROP TABLE IF EXISTS `SCHEDULE`;

-- ----------------------------
-- Create Table
-- ----------------------------
CREATE TABLE IF NOT EXISTS `SYS_INIT_RECORDS` (
   ID VARCHAR(40) PRIMARY KEY NOT NULL,
   INIT_DATE DATETIME NOT NULL,
   IS_SUCCEED BIT NOT NULL,
);

CREATE TABLE IF NOT EXISTS mx_node_image (
   ID VARCHAR(40) PRIMARY KEY NOT NULL,
   CRT_DTTM DATETIME NOT NULL,
   CRT_USER VARCHAR(255) NOT NULL,
   ENABLE_FLAG BIT NOT NULL,
   LAST_UPDATE_DTTM DATETIME NOT NULL,
   LAST_UPDATE_USER VARCHAR(255) NOT NULL,
   VERSION BIGINT,
   IMAGE_NAME VARCHAR(255),
   IMAGE_PATH VARCHAR(255),
   IMAGE_TYPE VARCHAR(255),
   IMAGE_URL VARCHAR(255),
);

-- ----------------------------
-- Add column
-- ----------------------------
ALTER TABLE `SYS_SCHEDULE` ADD COLUMN LAST_RUN_RESULT VARCHAR(255) COMMENT 'task last run result';
ALTER TABLE `FLOW_GROUP` ADD COLUMN FK_FLOW_GROUP_ID VARCHAR(40);
ALTER TABLE `FLOW_PROCESS_GROUP` ADD COLUMN FK_FLOW_PROCESS_GROUP_ID VARCHAR(40);
ALTER TABLE `FLOW_GROUP_TEMPLATE` ADD COLUMN TEMPLATE_TYPE VARCHAR(255) COMMENT 'template type';
ALTER TABLE `FLOW_PROCESS_GROUP` ADD COLUMN PAGE_ID VARCHAR(255);
ALTER TABLE `FLOW_TEMPLATE` ADD COLUMN SOURCE_FLOW_NAME VARCHAR(255) COMMENT 'source flow name';
ALTER TABLE `FLOW_TEMPLATE` ADD COLUMN TEMPLATE_TYPE VARCHAR(255) COMMENT 'template type';
ALTER TABLE `FLOW_TEMPLATE` ADD COLUMN URL VARCHAR(255);
ALTER TABLE `MX_GRAPH_MODEL` ADD COLUMN FK_PROCESS_ID VARCHAR(40);
ALTER TABLE `MX_GRAPH_MODEL` ADD COLUMN FK_PROCESS_GROUP_ID VARCHAR(40);
ALTER TABLE `FLOW_STOPS_PROPERTY` ADD COLUMN IS_OLD_DATA BIT(1) COMMENT 'Has it been updated';

-- ----------------------------
-- Add Foreign key
-- ----------------------------
ALTER TABLE `FLOW_GROUP` ADD CONSTRAINT FKe1i6t5gnt6ys4yqkt5uumr20w FOREIGN KEY (FK_FLOW_GROUP_ID) REFERENCES FLOW_GROUP (ID);
ALTER TABLE `FLOW_PROCESS_GROUP` ADD CONSTRAINT FKpxf1rth8fs0pld3jlvigkaf2y FOREIGN KEY (FK_FLOW_PROCESS_GROUP_ID) REFERENCES FLOW_PROCESS_GROUP (ID);
ALTER TABLE `MX_GRAPH_MODEL` ADD CONSTRAINT FKkw0r9m7r3jm9scab8caoxnnxc FOREIGN KEY (FK_PROCESS_ID) REFERENCES FLOW_PROCESS (ID);
ALTER TABLE `MX_GRAPH_MODEL` ADD CONSTRAINT FKnugg3p8uvupfu3mso2iax2g8t FOREIGN KEY (FK_PROCESS_GROUP_ID) REFERENCES FLOW_PROCESS_GROUP (ID);

-- ----------------------------
-- Update Data
-- ----------------------------
UPDATE SYS_SCHEDULE SS SET SS.LAST_RUN_RESULT='SUCCEED';
UPDATE `SYS_MENU` SS SET SS.ENABLE_FLAG=0;

-- ----------------------------
-- Insert Data
-- ----------------------------
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00001', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'Flows', 'USER', 'Flow', NULL, '/piflow-web/web/flowList', 100001);
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00002', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'FlowGroup', 'USER', 'Group', NULL, '/piflow-web/web/flowGroupList', 100001);
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00003', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'Process', 'USER', 'Process', NULL, '/piflow-web/web/processAndProcessGroup', 100002);
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00004', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'FlowGroupTemplate', 'USER', 'Template', NULL, '/piflow-web/web/flowTemplateList', 100003);
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00005', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'DataSource', 'USER', 'DataSource', NULL, '/piflow-web/web/dataSources', 400001);
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00006', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'Instruction', 'USER', 'Instruction', 'Example', '/piflow-web/web/instructionalVideo', 500001);
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00007', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'Example1', 'USER', 'Example1', 'Example', '/piflow-web/mxGraph/drawingBoard?drawingBoardType=TASK&load=0641076d5ae840c09d2be5b71fw00001', 500002);
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00008', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'Example2', 'USER', 'Example2', 'Example', '/piflow-web/mxGraph/drawingBoard?drawingBoardType=GROUP&load=0641076d5ae840c09d2be5b71fw00002', 500003);
INSERT INTO SYS_MENU(ID, CRT_DTTM, CRT_USER, ENABLE_FLAG, LAST_UPDATE_DTTM, LAST_UPDATE_USER, VERSION, MENU_DESCRIPTION, MENU_JURISDICTION, MENU_NAME, MENU_PARENT, MENU_URL, MENU_SORT) VALUES ('0641076d5ae840c09d2be6wmenu00009', parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 1, parsedatetime('01-01-2020 00:00:00.00', 'dd-MM-yyyy hh:mm:ss.SS'), 'system', 0, 'Schedule', 'ADMIN', 'Schedule', 'Admin', '/piflow-web/web/sysScheduleList', 900001);




